# Python рЃърЃарЃЮрЃћрЃЦрЃбрЃћрЃЉрЃў Nix + Flakes + direnv-рЃўрЃЌ  
## рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў, рЃЊрЃћрЃЎрЃџрЃљрЃарЃљрЃбрЃўрЃБрЃџрЃў рЃЊрЃљ рЃњрЃљрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃљрЃЊрЃў рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљ

---

## 1. рЃЏрЃўрЃќрЃљрЃюрЃў

рЃљрЃЏ рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃўрЃА рЃЏрЃўрЃќрЃљрЃюрЃўрЃљ рЃљрЃЕрЃЋрЃћрЃюрЃЮрЃА, рЃарЃЮрЃњрЃЮрЃа рЃљрЃЋрЃљрЃгрЃДрЃЮрЃЌ **Python рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃњрЃљрЃарЃћрЃЏрЃЮ** рЃўрЃАрЃћ, рЃарЃЮрЃЏ:

- рЃљрЃа рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉрЃЊрЃћрЃЌ `virtualenv`-рЃА
- рЃљрЃа рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉрЃЊрЃћрЃЌ `pip install`-рЃА
- рЃњрЃљрЃарЃћрЃЏрЃЮ рЃўрЃДрЃЮрЃА **рЃарЃћрЃърЃарЃЮрЃЊрЃБрЃфрЃўрЃарЃћрЃЉрЃљрЃЊрЃў**
- Python рЃЋрЃћрЃарЃАрЃўрЃљ рЃўрЃДрЃЮрЃА **рЃърЃарЃЮрЃћрЃЦрЃбрЃќрЃћ рЃЏрЃўрЃЉрЃЏрЃБрЃџрЃў**
- Django / Flask / pytest рЃЊрЃљрЃћрЃЏрЃљрЃбрЃЮрЃА **рЃћрЃарЃЌ рЃ«рЃљрЃќрЃерЃў**

рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃбрЃћрЃЦрЃюрЃЮрЃџрЃЮрЃњрЃўрЃћрЃЉрЃў:

- NixOS РЅЦ 25.11
- flakes (рЃАрЃљрЃЋрЃљрЃџрЃЊрЃћрЃЉрЃБрЃџрЃЮ)
- direnv
- Python (3.12 / 3.14 рЃЊрЃљ рЃАрЃ«рЃЋ.)

---

## 2. рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ рЃўрЃЊрЃћрЃљ (рЃЎрЃЮрЃюрЃфрЃћрЃцрЃфрЃўрЃљ)

> **Nix рЃЏрЃљрЃарЃЌрЃљрЃЋрЃА рЃњрЃљрЃарЃћрЃЏрЃЮрЃА.  
> Python рЃЏрЃљрЃарЃЌрЃљрЃЋрЃА рЃџрЃЮрЃњрЃўрЃЎрЃљрЃА.**

- Python рЃўрЃюрЃбрЃћрЃарЃърЃарЃћрЃбрЃљрЃбрЃЮрЃарЃў Рєњ flake
- Python рЃърЃљрЃЎрЃћрЃбрЃћрЃЉрЃў Рєњ flake (`pythonPackages`)
- рЃЎрЃЮрЃЊрЃў Рєњ `src/`
- рЃљрЃа рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃА:
  - virtualenv
  - requirements.txt рЃарЃЮрЃњрЃЮрЃарЃф truth
  - pip install

---

## 3. рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў flake.nix (рЃЉрЃљрЃќрЃљ)

рЃћрЃА рЃљрЃарЃўрЃА **рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃърЃљрЃбрЃљрЃарЃљ рЃАрЃгрЃЮрЃарЃў Python flake**, рЃарЃЮрЃЏрЃџрЃўрЃА рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃљрЃф рЃдрЃўрЃарЃА.

```nix
{
  description = "python dev shell";

  inputs.nixpkgs.url = "github:NixOS/nixpkgs/nixos-25.11";

  outputs = { self, nixpkgs }:
  let
    system = "x86_64-linux";
    pkgs = import nixpkgs { inherit system; };

    py = pkgs.python314;
    pypkgs = pkgs.python314Packages;
  in {
    devShells.${system}.default = pkgs.mkShell {
      packages = [
        py
      ];
    };
  };
}
````

рЃћрЃА рЃњрЃљрЃФрЃџрЃћрЃЋрЃА:

```bash
python --version
# Python 3.14.x
```

рЃЊрЃљ рЃЏрЃћрЃбрЃў рЃљрЃарЃљрЃцрЃћрЃарЃў.

---

## 4. direnv рЃўрЃюрЃбрЃћрЃњрЃарЃљрЃфрЃўрЃљ

`.envrc` рЃцрЃљрЃўрЃџрЃў **рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА**:

```sh
use flake
```

рЃърЃўрЃарЃЋрЃћрЃџ рЃерЃћрЃАрЃЋрЃџрЃљрЃќрЃћ:

```bash
direnv allow
```

рЃћрЃА рЃљрЃарЃўрЃА рЃБрЃАрЃљрЃцрЃарЃЌрЃ«рЃЮрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃЌрЃ«рЃЮрЃЋрЃюрЃљ рЃЊрЃљ **рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃўрЃќрЃљрЃфрЃўрЃљ рЃљрЃа рЃБрЃюрЃЊрЃљ рЃАрЃфрЃљрЃЊрЃЮ**.

---

## 5. Python рЃърЃљрЃЎрЃћрЃбрЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃљ (рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃАрЃўрЃљ рЃўрЃќрЃарЃЊрЃћрЃЉрЃљ)

### pytest

```nix
packages = [
  py
  pypkgs.pytest
];
```

### Django

```nix
packages = [
  py
  pypkgs.django
];
```

### Flask

```nix
packages = [
  py
  pypkgs.flask
];
```

### рЃарЃћрЃљрЃџрЃБрЃарЃў рЃърЃарЃЮрЃћрЃЦрЃбрЃў

```nix
packages = [
  py
  pypkgs.django
  pypkgs.pytest
  pypkgs.python-dotenv
];
```

­ЪЉЅ **flake-рЃўрЃА рЃАрЃ«рЃЋрЃљ рЃюрЃљрЃгрЃўрЃџрЃў рЃљрЃа рЃўрЃфрЃЋрЃџрЃћрЃЉрЃљ.**

---

## 6. Django-рЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ

Django flake-рЃерЃў рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ:

```bash
django-admin startproject mysite .
python manage.py runserver
```

рЃљрЃа рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃА:

* pip install
* virtualenv
* рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў Python

рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў рЃЏрЃЮрЃЊрЃўрЃА nixpkgs-рЃЊрЃљрЃю.

---

## 7. рЃарЃљрЃбрЃЮрЃЏ рЃљрЃа рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉрЃЌ virtualenv-рЃА

| рЃбрЃарЃљрЃЊрЃўрЃфрЃўрЃБрЃџрЃў Python          | Nix + Flakes |
| -------------------------- | ------------ |
| virtualenv                 | РЮї            |
| pip install                | РЮї            |
| requirements drift         | РЮї            |
| рЃћрЃарЃЌ Python-рЃА рЃўрЃДрЃћрЃюрЃћрЃЉрЃА рЃДрЃЋрЃћрЃџрЃљ | РЮї            |
| рЃърЃарЃЮрЃћрЃЦрЃбрЃќрЃћ рЃЏрЃўрЃЉрЃЏрЃБрЃџрЃў Python    | РюЁ            |
| рЃарЃћрЃърЃарЃЮрЃЊрЃБрЃфрЃўрЃарЃћрЃЉрЃљрЃЊрЃў рЃњрЃљрЃарЃћрЃЏрЃЮ     | РюЁ            |

virtualenv рЃљрЃарЃўрЃА workaround.
Nix рЃљрЃарЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ.

---

## 8. flake-рЃўрЃА рЃАрЃбрЃўрЃџрЃў (рЃарЃљрЃбрЃЮрЃЏ py / pypkgs)

```nix
py = pkgs.python314;
pypkgs = pkgs.python314Packages;
```

рЃљрЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃДрЃЋрЃћрЃџрЃњрЃљрЃю рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ:

```nix
py
pypkgs.django
pypkgs.pytest
```

рЃћрЃА рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА:

* рЃЋрЃћрЃарЃАрЃўрЃўрЃА рЃерЃћрЃфрЃЋрЃџрЃљрЃА рЃћрЃарЃЌ рЃ«рЃљрЃќрЃерЃў
* рЃАрЃўрЃАрЃБрЃцрЃЌрЃљрЃЋрЃћрЃА
* рЃЎрЃЮрЃЊрЃўрЃА рЃгрЃљрЃЎрЃўрЃЌрЃ«рЃЋрЃљрЃЊрЃЮрЃЉрЃљрЃА

---

## 9. Makefile-рЃўрЃЌ рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃљ (рЃўрЃЊрЃћрЃљ)

flake рЃБрЃюрЃЊрЃљ рЃњрЃћрЃюрЃћрЃарЃўрЃарЃЊрЃћрЃЉрЃЮрЃЊрЃћрЃА **рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃцрЃЮрЃарЃЏрЃўрЃЌ**, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЎрЃў:

* рЃБрЃЉрЃарЃљрЃџрЃЮрЃЊ рЃЊрЃљрЃћрЃЏрЃљрЃбрЃЮрЃА рЃърЃљрЃЎрЃћрЃбрЃћрЃЉрЃўрЃА рЃАрЃљрЃ«рЃћрЃџрЃћрЃЉрЃў
* рЃљрЃа рЃерЃћрЃўрЃфрЃЋрЃљрЃџрЃЮрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ

рЃАрЃгрЃЮрЃарЃў рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљ:

* рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃљ Рєњ рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў flake
* рЃќрЃарЃЊрЃљ Рєњ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ `packages = [ ... ]`

---

## 10. рЃФрЃўрЃарЃўрЃЌрЃљрЃЊрЃў рЃгрЃћрЃАрЃћрЃЉрЃў (рЃерЃћрЃ»рЃљрЃЏрЃћрЃЉрЃљ)

* flake = wiring, рЃљрЃарЃљ рЃџрЃЮрЃњрЃўрЃЎрЃљ
* Python рЃЋрЃћрЃарЃАрЃўрЃљ Рєњ рЃћрЃарЃЌ рЃљрЃЊрЃњрЃўрЃџрЃќрЃћ
* рЃърЃљрЃЎрЃћрЃбрЃћрЃЉрЃў Рєњ рЃћрЃарЃЌрЃў рЃАрЃўрЃљ
* direnv allow Рєњ рЃДрЃЮрЃЋрЃћрЃџрЃЌрЃЋрЃўрЃА рЃ«рЃћрЃџрЃўрЃЌ
* pip / venv Рєњ рЃљрЃа рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ
* рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў Рєњ рЃЊрЃћрЃЎрЃџрЃљрЃарЃљрЃбрЃўрЃБрЃџрЃў

---

## 11. рЃЊрЃљрЃАрЃЎрЃЋрЃюрЃљ

рЃћрЃА рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљ рЃўрЃФрЃџрЃћрЃЋрЃљ:

* рЃАрЃБрЃцрЃЌрЃљ Python рЃърЃарЃЮрЃћрЃЦрЃбрЃћрЃЉрЃА
* рЃЏрЃљрЃарЃбрЃўрЃЋ рЃњрЃљрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃљрЃА (Django, Flask, pytest)
* рЃћрЃарЃЌрЃюрЃљрЃўрЃа рЃњрЃљрЃарЃћрЃЏрЃЮрЃА рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃљрЃюрЃЦрЃљрЃюрЃљрЃќрЃћ
* рЃЎрЃЮрЃюрЃбрЃарЃЮрЃџрЃА рЃЊрЃљ рЃАрЃўрЃЏрЃерЃЋрЃўрЃЊрЃћрЃА

> **рЃЌрЃБ рЃњрЃљрЃарЃћрЃЏрЃЮ рЃљрЃа рЃљрЃарЃўрЃА рЃљрЃдрЃгрЃћрЃарЃўрЃџрЃў Рђћ рЃўрЃА рЃљрЃа рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃА.
> flake рЃљрЃарЃўрЃА рЃћрЃарЃЌрЃљрЃЊрЃћрЃарЃЌрЃў рЃАрЃўрЃЏрЃљрЃарЃЌрЃџрЃћ.**

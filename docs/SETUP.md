# SETUP Рђћ NixOS Flake Dev Machine (Laptop)

рЃћрЃА рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃў рЃљрЃдрЃгрЃћрЃарЃА **рЃюрЃљрЃЉрЃўрЃ»-рЃюрЃљрЃЉрЃўрЃ» рЃърЃарЃЮрЃфрЃћрЃАрЃА**, рЃарЃЮрЃњрЃЮрЃа рЃљрЃЋрЃљрЃгрЃДрЃЮрЃЌ рЃћрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ
**рЃАрЃарЃБрЃџрЃў рЃюрЃБрЃџрЃўрЃЊрЃљрЃю**, Flake-рЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃЌ.

Рюћ рЃњрЃљрЃЌрЃЋрЃџрЃўрЃџрЃўрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ **NixOS 25.11+**-рЃќрЃћ  
Рюќ рЃФрЃЋрЃћрЃџрЃў рЃЋрЃћрЃарЃАрЃўрЃћрЃЉрЃў рЃљрЃа рЃњрЃљрЃюрЃўрЃ«рЃўрЃџрЃћрЃЉрЃљ

---

## ­Ъј» рЃгрЃўрЃюрЃљрЃърЃўрЃарЃЮрЃЉрЃћрЃЉрЃў

рЃАрЃљрЃГрЃўрЃарЃЮрЃљ:

- x86_64 рЃџрЃћрЃърЃбрЃЮрЃърЃў
- рЃўрЃюрЃбрЃћрЃарЃюрЃћрЃб рЃЎрЃљрЃЋрЃерЃўрЃарЃў
- NixOS Live ISO (25.11+ channel)
- рЃАрЃљрЃЉрЃљрЃќрЃўрЃАрЃЮ Linux рЃфрЃЮрЃЊрЃюрЃљ (terminal)

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 1 Рђћ Live ISO

1. рЃЕрЃљрЃўрЃбрЃЋрЃўрЃарЃЌрЃћ NixOS Live ISO-рЃЊрЃљрЃю
2. рЃњрЃљрЃ«рЃАрЃћрЃюрЃў terminal
3. рЃЊрЃљрЃарЃгрЃЏрЃБрЃюрЃЊрЃў, рЃарЃЮрЃЏ рЃЦрЃАрЃћрЃџрЃў рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА:
```bash
ping nixos.org
````

рЃЌрЃБ рЃЦрЃАрЃћрЃџрЃў рЃљрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА Рђћ рЃ»рЃћрЃа рЃћрЃА рЃЏрЃЮрЃљрЃњрЃЋрЃљрЃарЃћ, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃљрЃљрЃњрЃарЃФрЃћрЃџрЃћ.

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 2 Рђћ рЃЊрЃўрЃАрЃЎрЃўрЃА рЃЏрЃЮрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃљ

> Рџа№ИЈ рЃћрЃА рЃюрЃљрЃЉрЃўрЃ»рЃў рЃљрЃюрЃљрЃЊрЃњрЃБрЃарЃћрЃЉрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА

рЃЊрЃўрЃАрЃЎрЃўрЃА рЃњрЃљрЃДрЃЮрЃцрЃљ рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ:

* `disko`
* `parted`
* рЃљрЃю рЃ«рЃћрЃџрЃўрЃЌ

рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃърЃарЃўрЃюрЃфрЃўрЃърЃў:

* `/` рЃЊрЃљ `/boot` рЃБрЃюрЃЊрЃљ рЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃЊрЃћрЃА
* filesystem рЃБрЃюрЃЊрЃљ рЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЮрЃЊрЃћрЃА `hardware.nix`-рЃА

рЃЊрЃўрЃАрЃЎрЃўрЃА рЃЏрЃЮрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ:

```bash
mount /dev/<root-partition> /mnt
mount /dev/<boot-partition> /mnt/boot
```

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 3 Рђћ рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ

Clone рЃњрЃљрЃљрЃЎрЃћрЃЌрЃћ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа `/mnt`-рЃерЃў:

```bash
cd /mnt
git clone https://github.com/avtotrainer/flake.git
cd flake
```

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 4 Рђћ Hardware config-рЃўрЃА рЃерЃћрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃљ

рЃерЃћрЃљрЃЏрЃЮрЃгрЃЏрЃћ:

```text
hosts/laptop/hardware.nix
```

рЃЊрЃљрЃарЃгрЃЏрЃБрЃюрЃЊрЃў, рЃарЃЮрЃЏ:

* filesystem UUID-рЃћрЃЉрЃў рЃАрЃгрЃЮрЃарЃўрЃљ
* CPU/GPU рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў рЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљ рЃерЃћрЃюрЃА рЃџрЃћрЃърЃбрЃЮрЃърЃА

рЃЌрЃБ рЃАрЃљрЃГрЃўрЃарЃЮрЃљ:

```bash
nixos-generate-config --root /mnt
```

рЃЊрЃљ рЃерЃћрЃљрЃЊрЃљрЃарЃћ рЃљрЃарЃАрЃћрЃЉрЃБрЃџрЃў `hardware.nix`-рЃА.

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 5 Рђћ рЃърЃўрЃарЃЋрЃћрЃџрЃў build

рЃърЃўрЃарЃЋрЃћрЃџрЃў рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃљрЃњрЃћрЃЉрЃљ:

```bash
nixos-install --flake .#laptop
```

Рџа№ИЈ рЃћрЃА рЃюрЃљрЃЉрЃўрЃ»рЃў:

* рЃЊрЃљрЃљрЃўрЃюрЃАрЃбрЃљрЃџрЃўрЃарЃћрЃЉрЃА рЃАрЃўрЃАрЃбрЃћрЃЏрЃљрЃА
* рЃЕрЃљрЃгрЃћрЃарЃА bootloader-рЃА
* рЃерЃћрЃЦрЃЏрЃюрЃўрЃА users-рЃА

рЃЊрЃљрЃАрЃарЃБрЃџрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ:

```bash
reboot
```

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 6 Рђћ рЃърЃўрЃарЃЋрЃћрЃџрЃў boot

рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ:

1. рЃерЃћрЃЊрЃў user-рЃўрЃЌ
2. рЃњрЃљрЃЊрЃљрЃљрЃЏрЃЮрЃгрЃЏрЃћ рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЏрЃЊрЃњрЃЮрЃЏрЃљрЃарЃћрЃЮрЃЉрЃљ:

```bash
nixos-version
```

рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА **25.11+**

---

## ­ЪЪб рЃћрЃбрЃљрЃърЃў 7 Рђћ рЃДрЃЮрЃЋрЃћрЃџрЃЊрЃдрЃўрЃБрЃарЃў workflow

рЃАрЃўрЃАрЃбрЃћрЃЏрЃўрЃА рЃЏрЃљрЃарЃЌрЃЋрЃљ рЃ«рЃЊрЃћрЃЉрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ flake-рЃўрЃЌ:

```bash
cd ~/flake
sudo nixos-rebuild switch --flake .#laptop
```

рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃљрЃфрЃўрЃљ:

* рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљрЃЏрЃЊрЃћ Рђћ `git commit`
* рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ Рђћ rebuild
* рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃўрЃАрЃљрЃА Рђћ rollback

---

## ­ЪћЂ Rollback

рЃЌрЃБ рЃарЃљрЃЏрЃћ рЃњрЃљрЃцрЃБрЃГрЃЊрЃљ:

```bash
sudo nixos-rebuild switch --rollback
```

рЃљрЃю boot-рЃўрЃА рЃЊрЃарЃЮрЃА рЃљрЃўрЃарЃЕрЃўрЃћ рЃгрЃўрЃюрЃљ generation.

---

## Рџа№ИЈ рЃњрЃљрЃЋрЃарЃфрЃћрЃџрЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃў рЃўрЃюрЃАрЃбрЃљрЃџрЃљрЃфрЃўрЃўрЃАрЃљрЃА

### 1. рЃљрЃарЃљрЃАрЃгрЃЮрЃарЃў hardware.nix

рЃерЃћрЃЊрЃћрЃњрЃў:

* рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ рЃљрЃа boot-рЃЊрЃћрЃЉрЃљ
* Wi-Fi / GPU рЃљрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА

рЃњрЃљрЃЏрЃЮрЃАрЃљрЃЋрЃљрЃџрЃў:

* рЃњрЃљрЃЊрЃљрЃљрЃЏрЃЮрЃгрЃЏрЃћ UUID-рЃћрЃЉрЃў
* рЃерЃћрЃљрЃЊрЃљрЃарЃћ nixos-generate-config-рЃА

---

### 2. Flake name-рЃўрЃА рЃљрЃарЃљрЃАрЃгрЃЮрЃарЃў рЃЏрЃўрЃЌрЃўрЃЌрЃћрЃЉрЃљ

```bash
.#laptop
```

рЃБрЃюрЃЊрЃљ рЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЮрЃЊрЃћрЃА:

```nix
nixosConfigurations.laptop
```

---

### 3. Home Manager-рЃўрЃА рЃќрЃћрЃЊрЃЏрЃћрЃбрЃў рЃџрЃЮрЃњрЃўрЃЎрЃљ

рЃљрЃа рЃАрЃфрЃљрЃЊрЃЮ:

* WM-рЃўрЃА рЃњрЃљрЃЊрЃљрЃбрЃљрЃюрЃљ HM-рЃерЃў
* system рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА user.nix-рЃерЃў рЃЕрЃљрЃДрЃарЃљ

---

## ­ЪДа рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃљрЃфрЃўрЃћрЃЉрЃў

* рЃћрЃарЃЌрЃў рЃфрЃЋрЃџрЃўрЃџрЃћрЃЉрЃљ = рЃћрЃарЃЌрЃў commit
* flake.lock рЃљрЃа рЃгрЃљрЃерЃљрЃџрЃЮ
* рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃћрЃЉрЃў рЃњрЃљрЃљрЃЎрЃћрЃЌрЃћ рЃфрЃљрЃџрЃЎрЃћ branch-рЃќрЃћ
* host-рЃўрЃА рЃЎрЃЮрЃърЃўрЃарЃћрЃЉрЃљ РЅа hardware-рЃўрЃА рЃЎрЃЮрЃърЃўрЃарЃћрЃЉрЃљ

---

## ­ЪЊї рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃюрЃљрЃЉрЃўрЃ»рЃў

рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃў:
­ЪЉЅ **`CHECKLIST.md`**

рЃћрЃА рЃўрЃЦрЃюрЃћрЃЉрЃљ:

* рЃЏрЃЮрЃЎрЃџрЃћ
* рЃърЃарЃљрЃЦрЃбрЃўрЃЎрЃБрЃџрЃў
* рЃДрЃЮрЃЋрЃћрЃџрЃЊрЃдрЃўрЃБрЃарЃў рЃњрЃљрЃЊрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА

---

**рЃћрЃА рЃўрЃюрЃАрЃбрЃарЃБрЃЦрЃфрЃўрЃљ рЃњрЃљрЃюрЃЎрЃБрЃЌрЃЋрЃюрЃўрЃџрЃўрЃљ рЃарЃћрЃљрЃџрЃБрЃарЃў рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.
рЃљрЃарЃљ рЃЊрЃћрЃЏрЃЮрЃАрЃЌрЃЋрЃўрЃА.**

